# Corp

### Bypassing Applocker

AppLocker is an application whitelisting technology introduced with Windows 7. It allows restricting which 
programs users can execute based on the programs path, publisher, and hash.

There are many ways to bypass AppLocker.

If AppLocker is configured with default AppLocker rules, we can bypass it by placing our executable in the 
following directory: C:\Windows\System32\spool\drivers\color - This is whitelisted by default. 

Just like Linux bash, Windows Powershell saves all previous commands into a file called ConsoleHost_history. 
This is located at 
`%userprofile%\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadline\ConsoleHost_history.txt`

### Kerberoasting

First step is to enumerate Windows. If we run `setspn -T medin -Q */*` we can extract all accounts in 
the SPN.

SPN is the Service Principal Name, and is the mapping between service and account.

Now we have seen there is an SPN for a user, we can use Invoke-Kerberoast and get a ticket.

Lets first download the Powershell [Invoke-Kerberoast](https://raw.githubusercontent.com/EmpireProject/Empire/master/data/module_source/credentials/Invoke-Kerberoast.ps1) and import the module.

Use `Invoke-Kerberos -OutputFormat hashcat |fl` to extract the SPN ticket

Next, use hashcat to bruteforce the password

`hashcat -m 13100 -a 0 hash.txt rockyou.txt`
